-1!==window.location.hash.indexOf("access_token")&&(window.location.hash=window.location.hash.replace(/access_token[^&]*&?/,"")),function(t,e,i){"use strict";var s,n={is_mobile:!1,target_height:240,selector:".thumb-frame",parent_class:"ftl-thumb-mosaic",indicator:".video-chin",spacing:8,oneRow:!1,renderLargeThumbnails:!0,featureFlags:{}};function a(t,e){var i;if(t&&!t.dataset.mosaicInitialized){for(i in t.dataset.mosaicInitialized="true",this.container=t,this.settings={},this.assetType=e&&e.assetType||null,n)e&&e.hasOwnProperty(i)?this.settings[i]=e[i]:n.hasOwnProperty(i)&&(this.settings[i]=n[i]);this._initialize()}}"function"!=typeof e.CustomEvent&&(e.CustomEvent=function(e,i){i=i||{bubbles:!1,cancelable:!1,detail:null};var s=t.createEvent("CustomEvent");return s.initCustomEvent(e,i.bubbles,i.cancelable,i.detail),s},e.CustomEvent.prototype=e.Event.prototype),s=new CustomEvent("mosaicLayoutChanged",{detail:{message:"Mosaic Layout Changed",time:new Date},bubbles:!0,cancelable:!0}),a.prototype._initialize=function(){this.images=this.container.querySelectorAll(this.settings.selector),this.indicator=this.container.querySelector(this.settings.indicator),this.images_sizes=[],this.images_parents=[],this.sidebar=t.getElementById("sidebar-container"),this.panel=t.getElementById("slide-in-panel"),this.mosaicContainer=t.getElementById("mosaic-container"),this.images.length&&this._scaleLibrary(!1),this.event_handlers_set||(this.event_handlers_set=!0,this.settings.is_mobile?e.addEventListener("orientationchange",this._onReloadMosaic.bind(this)):e.addEventListener("resize",this._onWindowResize.bind(this)),e.addEventListener("reload.adobestock_mosaic",this._onReloadMosaic.bind(this)))},a.prototype.getTargetHeight=function(){if("templates"===this.assetType&&!this.settings.is_mobile)return 320;return!this.settings.is_mobile&&this.assetType&&-1===["3d","3D","templates","videos"].indexOf(this.assetType)?360:240},a.prototype.getContainerWidth=function(){var i,s=0,n=0,a=0,o=t.body.getBoundingClientRect().width,r=this.sidebar?this.sidebar.offsetWidth:0,h=this.panel?this.panel.offsetWidth:0;return this.mosaicContainer&&(i=e.getComputedStyle(this.mosaicContainer,null),s=parseInt(i.getPropertyValue("padding-left"),10)||0,n=parseInt(i.getPropertyValue("padding-right"),10)||0,a=this.mosaicContainer.style.width),(a?parseInt(a,10):o)-r-h-s-n},a.prototype._scaleLibrary=function(e){var n=this,a=0,o=0,r=0,h=0,l=this.settings.renderLargeThumbnails?this.getTargetHeight():this.settings.target_height;if(!0!==e&&(this.resize_waiting=!0,this.container.style.width="100%",this.container_width=this.getContainerWidth()),this.rows=[],this.rows_widths=[],Array.prototype.forEach.call(this.images,function(t,e){var s,g=n._getImageSizesById(e),d=g[0],c=g[1],m=d/c*l,p=l;c>h&&(h=c),n.rows[a]===i&&(n.rows[a]=[]),r+=m+n.settings.spacing,s={id:e,element:t,new_image_width:m,new_image_height:p,row:a+1,column:o+1},n.rows[a].push(s),o++,r>n.container_width-n.settings.spacing?(n.rows_widths[a]=r-n.settings.spacing,a++,o=0,r=0):e===n.images.length-1&&(n.rows_widths[a]=r)}),this.settings.target_height>h)this.settings.target_height=h,this._scaleLibrary(!0);else{for(a in this.rows)this._resizeRow(a);this.resize_waiting=!1}if(t.dispatchEvent(s),this.settings.oneRow){var g=this.container.querySelector(this.settings.selector);g&&(this.container.style.height=g.style.height)}},a.prototype._resizeRow=function(t){var e,i=this,s=this.rows[t],n=this.settings.spacing*(s.length-1),a=(this.container_width-n)/(this.rows_widths[t]-n),o=!(this.rows.length-t!=1);s.forEach(function(n,r){e=!(s.length-r!=1),i._resizeImage(s[r],[e,o,a,t])})},a.prototype._resizeImage=function(t,e){var i,s=e[0],n=e[1],a=e[2],o=e[3],r=Math.floor(t.new_image_width*a),h=Math.floor(t.new_image_height*a);if(n&&this.container_width>this.rows_widths[o]&&(r=t.new_image_width,h=t.new_image_height),t.element.style.width=r+"px",t.element.style.height=h+"px",t.element.setAttribute("data-row",t.row),t.element.setAttribute("data-column",t.column),this.indicator&&r&&h&&this.indicator.classList.remove("hidden"),i=this._getImageParentElm(t.id,t.element)){i.setAttribute("data-ingest-position",t.row+","+t.column),i.style.marginRight=s?"0px":this.settings.spacing+"px";var l=i.getAttribute("data-content-type");if(l&&-1!==l.indexOf("audio")&&this._resizeAudioElement(t),320===this.getTargetHeight()){const t="hide-chin-title";r<202?i.classList.add(t):i.classList.contains(t)&&i.classList.remove(t)}}},a.prototype._onWindowResize=function(t){var i=this;return i.resize_waiting||(i.resize_waiting=!0,e.setTimeout(function(){i._scaleLibrary(!1)},100)),t.preventDefault(),!1},a.prototype._onReloadMosaic=function(t){t&&t.detail&&t.detail.assetType&&(this.assetType=t.detail.assetType),this._initialize()},a.prototype._getImageSizesById=function(t){if(this.images[t]===i)this.images_sizes[t]=[0,0];else if(this.images_sizes[t]===i){var e=this.images[t],s=e.dataset.width||e.outerWidth,n=e.dataset.height||e.outerHeight;"true"===e.dataset.isChinBelow&&(s*=.85),this.images_sizes[t]=[parseInt(s,10),parseInt(n,10)]}return this.images_sizes[t]},a.prototype._getImageParentElm=function(t,e){if(this.images_parents[t]===i)for(;null!==(e=e.parentElement);)if(e.nodeType===Node.ELEMENT_NODE&&e.classList.contains(this.settings.parent_class)){this.images_parents[t]=e;break}return this.images_parents[t]},a.prototype._resizeAudioElement=function(t){var e=t.element.querySelector(".audio-card-container");if(e){var i=Number.parseInt(t.element.style.height),s=Number.parseInt(t.element.style.width);e.classList.remove("big","small","x-small"),i<124||s<220?e.classList.add("x-small"):i<240||s<427?e.classList.add("small"):(i<360||s<640)&&e.classList.add("big")}},e.adobestock_mosaic=a}(document,window);
